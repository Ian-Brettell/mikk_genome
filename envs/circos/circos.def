Bootstrap: docker
From: perl:latest

%environment
    export PATH="$PATH:/usr/local/circos-0.69-9/bin"

%post
    # Standard linux
    apt-get update && apt-get -y upgrade
    apt-get -y install \
      build-essential \
      wget \
      bzip2 \
      ca-certificates \
      libglib2.0-0 \
      libxext6 \
      libsm6 \
      libxrender1 \
      git \
      locales \
      curl
    rm -rf /var/lib/apt/lists/*
    apt-get clean

    # Install Circos
    wget http://circos.ca/distribution/circos-0.69-9.tgz
    tar xvfz circos-0.69-9.tgz
    cd circos-0.69-9

    # Install required libs
    ## libpng
    wget http://circos.ca/distribution/lib/libpng-1.6.14.tar.gz
    tar xvfz libpng-1.6.14.tar.gz
    cd libpng-1.6.14
    ./configure -prefix=/usr/local
    make
    make install

    ## jpegsrc
    wget http://circos.ca/distribution/lib/jpegsrc.v9.tar.gz
    tar xvfz jpegsrc.v9.tar.gz
    cd jpeg-9
    ./configure -prefix=/usr/local
    make
    make install

    ## freetype
    wget http://circos.ca/distribution/lib/freetype-2.4.0.tar.gz
    tar xvfz freetype-2.4.0.tar.gz
    cd freetype-2.4.0
    ./configure -prefix=/usr/local
    make
    make install
